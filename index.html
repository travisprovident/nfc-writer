<!DOCTYPE html>
<html>
<head>
  <title>NFC Writer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="ProvLogo.png" type="image/png">
</head>
<body>

<div id="topNavBar">
  <button id="goBackBtn" class="nav-icon-button" title="Return to Tracker">←</button>

  <div id="logoSlot">
    <img src="Provident_HeaderLogo_520_Over.webp" id="logoImage" />
  </div>

  <button id="resetBtn" class="nav-icon-button" title="Reset NFC Session">⟳</button>
</div>

  <div id="nfcWrapper">
    <h2>NFC Tag Writer</h2>

    <div class="form-group">
      <label for="modeSelect">Choose Mode:</label>
      <select id="modeSelect">
        <option value="single">Single Asset</option>
        <option value="batch">Batch Write</option>
      </select>
    </div>

    <div id="singleMode" class="mode-section">
      <div class="form-group">
        <label for="companySelectSingle">Choose Company:</label>
        <select id="companySelectSingle">
          <option value="">-- Select Company --</option>
          <option value="https://tinyurl.com/yr4c8nfc?id=">Provident Asset Tracker</option>
          <option value="https://tinyurl.com/2e88evx9?id=">Ideal Asset Tracker</option>
          <option value="https://tinyurl.com/2fc45ykf?id=">Alpha Asset Tracker</option>
          <option value="https://tinyurl.com/2cpxwvxn?id=">Ensign Asset Tracker</option>
          <option value="https://tinyurl.com/4c9r7ybn?id=">Other Asset Tracker</option>
        </select>
      </div>

      <div class="form-group">
        <label for="baseUrlSingle">Base URL</label>
        <input id="baseUrlSingle" type="text" placeholder="Enter base URL" />
      </div>

      <div class="form-group">
        <label for="assetIdSingle">Asset ID</label>
        <input id="assetIdSingle" type="text" placeholder="Enter asset ID" />
      </div>

      <div class="form-group">
        <button id="writeSingle" type="button" class="write-button">Write to NFC Tag</button>
        <button id="cancelScanSingle" class="cancel-scan">❌ Cancel Scan</button>
      </div>
    </div>

    <div id="batchMode" class="mode-section">
      <div class="form-group">
        <label for="companySelectBatch">Choose Company:</label>
        <select id="companySelectBatch">
          <option value="">-- Select Company --</option>
          <option value="https://tinyurl.com/yr4c8nfc?id=">Provident Asset Tracker</option>
          <option value="https://tinyurl.com/2e88evx9?id=">Ideal Asset Tracker</option>
          <option value="https://tinyurl.com/2fc45ykf?id=">Alpha Asset Tracker</option>
          <option value="https://tinyurl.com/2cpxwvxn?id=">Ensign Asset Tracker</option>
          <option value="https://tinyurl.com/22kyyfsv?id=">Mesa Asset Tracker</option>
          <option value="https://tinyurl.com/4c9r7ybn?id=">Other Asset Tracker</option>
        </select>
      </div>

      <div class="form-group">
        <label for="baseUrlBatch">Base URL</label>
        <input id="baseUrlBatch" type="text" placeholder="Enter base URL" />
      </div>

      <div class="form-group">
        <label for="assetList">Asset ID List (one per line)</label>
        <textarea id="assetList" rows="5" placeholder="123
124
125"></textarea>
      </div>

      <div class="form-group">
        <button id="startBatch" class="start-batch-button">Start Batch Write</button>
      </div>

      <div id="batchControls" style="display:none;">
        <div id="assetNavInfo">
          <p><strong>Current Asset:</strong> <span id="currentAsset"></span></p>
          <p id="assetCountDisplay" style="font-size: 0.9rem; color: #555;"></p>
        </div>
        <div class="form-group">
          <button id="writeBatch" class="write-button">Write Tag for Current Asset</button>
          <button id="cancelScanBatch" class="cancel-scan">❌ Cancel Scan</button>
        </div>
        <div class="form-group asset-nav-buttons" id="batchNavControls">
          <button id="prevAsset">⬅️ Previous</button>
          <button id="nextAsset">Next ➡️</button>
        </div>
      </div>
    </div>

    <div id="status"></div>
  </div>

  <audio id="successSound" src="ding.mp3" preload="auto"></audio>

  <script>
    document.getElementById("goBackBtn").addEventListener("click", () => {
      window.close();
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      if (typeof resetNfcSession === 'function') {
        resetNfcSession();
      } else {
        console.warn("resetNfcSession function not defined.");
      }
    });

    document.getElementById('assetList').addEventListener('focus', function () {
      this.placeholder = '';
    }, { once: true });
  </script>

  <script src="script/state.js"></script>
  <script src="script/write.js"></script>
  <script src="script/main.js"></script>
</body>
</html>
